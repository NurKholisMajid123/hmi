<div class="container-fluid">


  <!-- Success/Error Messages -->
  <% if (user.successMessage) { %>
    <div class="alert alert-success alert-dismissible fade show" role="alert">
      <i class="fas fa-check-circle me-2"></i><%= user.successMessage %>
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    <% delete user.successMessage; %>
  <% } %>

  <% if (user.errorMessage) { %>
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      <i class="fas fa-exclamation-circle me-2"></i><%= user.errorMessage %>
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    <% delete user.errorMessage; %>
  <% } %>

  <div class="row">
    <!-- Profile Card -->
    <div class="col-lg-4 mb-4">
      <div class="card shadow-sm">
        <div class="card-body text-center">
          <!-- Profile Photo -->
          <div class="mb-3">
            <% if (userData.profile_photo) { %>
              <img src="<%= userData.profile_photo %>" alt="Profile Photo" 
                   class="rounded-circle" 
                   style="width: 150px; height: 150px; object-fit: cover; border: 4px solid #e9ecef;">
            <% } else { %>
              <div class="rounded-circle bg-secondary d-inline-flex align-items-center justify-content-center" 
                   style="width: 150px; height: 150px; border: 4px solid #e9ecef;">
                <i class="fas fa-user fa-4x text-white"></i>
              </div>
            <% } %>
          </div>

          <!-- User Info -->
          <h4 class="mb-1"><%= userData.full_name %></h4>
          <p class="text-muted mb-2">@<%= userData.username %></p>
          
          <!-- Role Badge -->
          <span class="badge bg-primary mb-3">
            <i class="fas fa-user-tag me-1"></i><%= userData.role_name %>
          </span>

          <!-- Status Badge -->
          <% if (userData.is_active) { %>
            <span class="badge bg-success">
              <i class="fas fa-check-circle me-1"></i>Aktif
            </span>
          <% } else { %>
            <span class="badge bg-danger">
              <i class="fas fa-times-circle me-1"></i>Tidak Aktif
            </span>
          <% } %>

          <hr class="my-3">

          <!-- Quick Actions -->
          <div class="d-grid gap-2">
            <a href="/profile/edit" class="btn btn-outline-primary btn-sm">
              <i class="fas fa-edit me-1"></i> Edit Profil
            </a>
            <a href="/profile/change-password" class="btn btn-outline-secondary btn-sm">
              <i class="fas fa-key me-1"></i> Ubah Password
            </a>
          </div>
        </div>
      </div>

      <!-- Membership Card -->
      <div class="card shadow-sm mt-3">
        <div class="card-header bg-light">
          <h6 class="mb-0"><i class="fas fa-users me-2"></i>Keanggotaan</h6>
        </div>
        <div class="card-body">
          <!-- Ketua Bidang -->
          <% if (bidangKetua) { %>
            <div class="mb-3">
              <small class="text-muted d-block mb-1">Ketua Bidang</small>
              <span class="badge bg-success">
                <i class="fas fa-crown me-1"></i><%= bidangKetua.nama_bidang %>
              </span>
            </div>
          <% } %>

          <!-- Anggota Bidang -->
          <% if (bidangAnggotaList && bidangAnggotaList.length > 0) { %>
            <div class="mb-3">
              <small class="text-muted d-block mb-1">Anggota Bidang</small>
              <% bidangAnggotaList.forEach(bidang => { %>
                <span class="badge bg-info me-1 mb-1">
                  <i class="fas fa-users me-1"></i><%= bidang.nama_bidang %>
                </span>
              <% }); %>
            </div>
          <% } %>

          <!-- Departemen -->
          <% if (userData.departemen) { %>
            <div>
              <small class="text-muted d-block mb-1">Departemen</small>
              <span class="badge bg-warning">
                <i class="fas fa-briefcase me-1"></i><%= userData.departemen %>
              </span>
            </div>
          <% } %>

          <!-- No Membership -->
          <% if (!bidangKetua && (!bidangAnggotaList || bidangAnggotaList.length === 0) && !userData.departemen) { %>
            <p class="text-muted mb-0 small">
              <i class="fas fa-info-circle me-1"></i>Belum tergabung dalam bidang/departemen
            </p>
          <% } %>
        </div>
      </div>
    </div>

    <!-- Profile Details -->
    <div class="col-lg-8">
      <div class="card shadow-sm">
        <div class="card-header bg-light">
          <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>Informasi Profil</h5>
        </div>
        <div class="card-body">
          <div class="row mb-3">
            <div class="col-md-4">
              <strong><i class="fas fa-id-badge me-2 text-primary"></i>Username</strong>
            </div>
            <div class="col-md-8">
              <%= userData.username %>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-4">
              <strong><i class="fas fa-envelope me-2 text-primary"></i>Email</strong>
            </div>
            <div class="col-md-8">
              <%= userData.email %>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-4">
              <strong><i class="fas fa-user me-2 text-primary"></i>Nama Lengkap</strong>
            </div>
            <div class="col-md-8">
              <%= userData.full_name %>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-4">
              <strong><i class="fas fa-phone me-2 text-primary"></i>Nomor Telepon</strong>
            </div>
            <div class="col-md-8">
              <%= userData.phone || '-' %>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-4">
              <strong><i class="fas fa-map-marker-alt me-2 text-primary"></i>Alamat</strong>
            </div>
            <div class="col-md-8">
              <%= userData.address || '-' %>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-4">
              <strong><i class="fas fa-user-tag me-2 text-primary"></i>Role</strong>
            </div>
            <div class="col-md-8">
              <span class="badge bg-primary"><%= userData.role_name %></span>
              <small class="text-muted ms-2">(Level <%= userData.role_level %>)</small>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-4">
              <strong><i class="fas fa-toggle-on me-2 text-primary"></i>Status</strong>
            </div>
            <div class="col-md-8">
              <% if (userData.is_active) { %>
                <span class="badge bg-success">Aktif</span>
              <% } else { %>
                <span class="badge bg-danger">Tidak Aktif</span>
              <% } %>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-4">
              <strong><i class="fas fa-calendar-plus me-2 text-primary"></i>Terdaftar Sejak</strong>
            </div>
            <div class="col-md-8">
              <%= new Date(userData.created_at).toLocaleDateString('id-ID', {
                day: 'numeric',
                month: 'long',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
              }) %>
            </div>
          </div>

          <% if (userData.updated_at) { %>
          <div class="row">
            <div class="col-md-4">
              <strong><i class="fas fa-clock me-2 text-primary"></i>Terakhir Diperbarui</strong>
            </div>
            <div class="col-md-8">
              <%= new Date(userData.updated_at).toLocaleDateString('id-ID', {
                day: 'numeric',
                month: 'long',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
              }) %>
            </div>
          </div>
          <% } %>
        </div>
      </div>
    </div>
  </div>
</div>